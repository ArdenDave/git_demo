From manacleto7
From develop branch
made modifications
